---
title: Python 数据处理 -- Pandas
layout: post
img: pandas.jpg
tags: [Python, 数据处理]
---

# Pandas

Pandas is an open source, BSD-licensed library providing high-performance, easy-to-use data structures and data analysis tools for the Python programming language.

Library documentation: [http://pandas.pydata.org/](http://pandas.pydata.org/)

### General

**In:**


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
%matplotlib inline

# create a series
s = pd.Series([1,3,5,np.nan,6,8])
s
```

**Out:**


    0     1
    1     3
    2     5
    3   NaN
    4     6
    5     8
    dtype: float64



**In:**


```python
# create a data frame
dates = pd.date_range('20130101',periods=6)
df = pd.DataFrame(np.random.randn(6,4),index=dates,columns=list('ABCD'))
df
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td>-0.809526</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
      <td>-0.624413</td>
      <td> 0.474422</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.000782</td>
      <td> 0.146544</td>
      <td> 0.033628</td>
      <td>-0.419772</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# another way to create a data frame
df2 = pd.DataFrame(
    { 'A' : 1.,
      'B' : pd.Timestamp('20130102'),
      'C' : pd.Series(1,index=list(range(4)),dtype='float32'),
      'D' : np.array([3] * 4,dtype='int32'),
      'E' : 'foo' })
df2
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 1</td>
      <td>2013-01-02</td>
      <td> 1</td>
      <td> 3</td>
      <td> foo</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 1</td>
      <td>2013-01-02</td>
      <td> 1</td>
      <td> 3</td>
      <td> foo</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 1</td>
      <td>2013-01-02</td>
      <td> 1</td>
      <td> 3</td>
      <td> foo</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 1</td>
      <td>2013-01-02</td>
      <td> 1</td>
      <td> 3</td>
      <td> foo</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df2.dtypes
```

**Out:**


    A           float64
    B    datetime64[ns]
    C           float32
    D             int32
    E            object
    dtype: object



**In:**


```python
df.head()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td>-0.809526</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
      <td>-0.624413</td>
      <td> 0.474422</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df.index
```

**Out:**


    <class 'pandas.tseries.index.DatetimeIndex'>
    [2013-01-01, ..., 2013-01-06]
    Length: 6, Freq: D, Timezone: None



**In:**


```python
df.columns
```

**Out:**


    Index([u'A', u'B', u'C', u'D'], dtype='object')


**In:**

```python
df.values
```

**Out:**


    array([[  2.05240362e-01,   5.27602841e-01,   6.10052272e-01,
              4.69292270e-01],
           [  8.18112883e-01,  -8.94389618e-01,  -1.60283098e+00,
              8.62169894e-01],
           [ -1.46210940e+00,   4.83201108e-01,  -1.04497297e+00,
             -5.34226832e-01],
           [  7.19196807e-01,  -4.99809344e-01,   1.14578824e+00,
             -8.09525609e-01],
           [ -1.16105080e+00,  -1.15774007e-01,  -6.24412514e-01,
              4.74421893e-01],
           [  7.82298420e-04,   1.46543576e-01,   3.36282758e-02,
             -4.19771560e-01]])



**In:**


```python
# quick data summary
df.describe()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td> 6.000000</td>
      <td> 6.000000</td>
      <td> 6.000000</td>
      <td> 6.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.146638</td>
      <td>-0.058771</td>
      <td>-0.247125</td>
      <td> 0.007060</td>
    </tr>
    <tr>
      <th>std</th>
      <td> 0.957650</td>
      <td> 0.561381</td>
      <td> 1.036400</td>
      <td> 0.679012</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.462109</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td>-0.809526</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.870593</td>
      <td>-0.403801</td>
      <td>-0.939833</td>
      <td>-0.505613</td>
    </tr>
    <tr>
      <th>50%</th>
      <td> 0.103011</td>
      <td> 0.015385</td>
      <td>-0.295392</td>
      <td> 0.024760</td>
    </tr>
    <tr>
      <th>75%</th>
      <td> 0.590708</td>
      <td> 0.399037</td>
      <td> 0.465946</td>
      <td> 0.473139</td>
    </tr>
    <tr>
      <th>max</th>
      <td> 0.818113</td>
      <td> 0.527603</td>
      <td> 1.145788</td>
      <td> 0.862170</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df.T
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2013-01-01 00:00:00</th>
      <th>2013-01-02 00:00:00</th>
      <th>2013-01-03 00:00:00</th>
      <th>2013-01-04 00:00:00</th>
      <th>2013-01-05 00:00:00</th>
      <th>2013-01-06 00:00:00</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td> 0.205240</td>
      <td> 0.818113</td>
      <td>-1.462109</td>
      <td> 0.719197</td>
      <td>-1.161051</td>
      <td> 0.000782</td>
    </tr>
    <tr>
      <th>B</th>
      <td> 0.527603</td>
      <td>-0.894390</td>
      <td> 0.483201</td>
      <td>-0.499809</td>
      <td>-0.115774</td>
      <td> 0.146544</td>
    </tr>
    <tr>
      <th>C</th>
      <td> 0.610052</td>
      <td>-1.602831</td>
      <td>-1.044973</td>
      <td> 1.145788</td>
      <td>-0.624413</td>
      <td> 0.033628</td>
    </tr>
    <tr>
      <th>D</th>
      <td> 0.469292</td>
      <td> 0.862170</td>
      <td>-0.534227</td>
      <td>-0.809526</td>
      <td> 0.474422</td>
      <td>-0.419772</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# axis 0 is index, axis 1 is columns
df.sort_index(axis=1, ascending=False)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D</th>
      <th>C</th>
      <th>B</th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.469292</td>
      <td> 0.610052</td>
      <td> 0.527603</td>
      <td> 0.205240</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.862170</td>
      <td>-1.602831</td>
      <td>-0.894390</td>
      <td> 0.818113</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.534227</td>
      <td>-1.044973</td>
      <td> 0.483201</td>
      <td>-1.462109</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-0.809526</td>
      <td> 1.145788</td>
      <td>-0.499809</td>
      <td> 0.719197</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td> 0.474422</td>
      <td>-0.624413</td>
      <td>-0.115774</td>
      <td>-1.161051</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-0.419772</td>
      <td> 0.033628</td>
      <td> 0.146544</td>
      <td> 0.000782</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# can sort by values too
df.sort(columns='B')
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td>-0.809526</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
      <td>-0.624413</td>
      <td> 0.474422</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.000782</td>
      <td> 0.146544</td>
      <td> 0.033628</td>
      <td>-0.419772</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
    </tr>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
  </tbody>
</table>
</div>



### Selection

**In:**


```python
# select a column (yields a series)
df['A']
```

**Out:**


    2013-01-01    0.205240
    2013-01-02    0.818113
    2013-01-03   -1.462109
    2013-01-04    0.719197
    2013-01-05   -1.161051
    2013-01-06    0.000782
    Freq: D, Name: A, dtype: float64



**In:**


```python
# column names also attached to the object
df.A
```

**Out:**


    2013-01-01    0.205240
    2013-01-02    0.818113
    2013-01-03   -1.462109
    2013-01-04    0.719197
    2013-01-05   -1.161051
    2013-01-06    0.000782
    Freq: D, Name: A, dtype: float64



**In:**


```python
# slicing works
df[0:3]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df['20130102':'20130104']
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td>-0.809526</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# cross-section using a label
df.loc[dates[0]]
```

**Out:**


    A    0.205240
    B    0.527603
    C    0.610052
    D    0.469292
    Name: 2013-01-01 00:00:00, dtype: float64



**In:**


```python
# getting a scalar value
df.loc[dates[0], 'A']
```

**Out:**


    0.20524036189008577


**In:**

```python
# select via position
df.iloc[3]
```

**Out:**


    A    0.719197
    B   -0.499809
    C    1.145788
    D   -0.809526
    Name: 2013-01-04 00:00:00, dtype: float64



**In:**


```python
df.iloc[3:5,0:2]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# column slicing
df.iloc[:,1:3]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.527603</td>
      <td> 0.610052</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>-0.894390</td>
      <td>-1.602831</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td> 0.483201</td>
      <td>-1.044973</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-0.499809</td>
      <td> 1.145788</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-0.115774</td>
      <td>-0.624413</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.146544</td>
      <td> 0.033628</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# get a value by index
df.iloc[1,1]
```

**Out:**


    -0.89438961765370562


**In:**

```python
# boolean indexing
df[df.A > 0]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td>-0.809526</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.000782</td>
      <td> 0.146544</td>
      <td> 0.033628</td>
      <td>-0.419772</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df[df > 0]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.205240</td>
      <td> 0.527603</td>
      <td> 0.610052</td>
      <td> 0.469292</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>      NaN</td>
      <td>      NaN</td>
      <td> 0.862170</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>      NaN</td>
      <td> 0.483201</td>
      <td>      NaN</td>
      <td>      NaN</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>      NaN</td>
      <td> 1.145788</td>
      <td>      NaN</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>      NaN</td>
      <td> 0.474422</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.000782</td>
      <td> 0.146544</td>
      <td> 0.033628</td>
      <td>      NaN</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# filtering
df3 = df.copy()
df3['E'] = ['one', 'one', 'two', 'three', 'four', 'three']
df3[df3['E'].isin(['two', 'four'])]
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td>-0.534227</td>
      <td>  two</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
      <td>-0.624413</td>
      <td> 0.474422</td>
      <td> four</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# setting examples
df.at[dates[0],'A'] = 0
df.iat[0,1] = 0
df.loc[:, 'D'] = np.array([5] * len(df))
df
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.000000</td>
      <td> 0.000000</td>
      <td> 0.610052</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.161051</td>
      <td>-0.115774</td>
      <td>-0.624413</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td> 0.000782</td>
      <td> 0.146544</td>
      <td> 0.033628</td>
      <td> 5</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# dealing with missing data
df4 = df.reindex(index=dates[0:4],columns=list(df.columns) + ['E'])
df4.loc[dates[0]:dates[1],'E'] = 1
df4
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.000000</td>
      <td> 0.000000</td>
      <td> 0.610052</td>
      <td> 5</td>
      <td>  1</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 5</td>
      <td>  1</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td> 5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td> 5</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# drop rows with missing data
df4.dropna(how='any')
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.000000</td>
      <td> 0.00000</td>
      <td> 0.610052</td>
      <td> 5</td>
      <td> 1</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.89439</td>
      <td>-1.602831</td>
      <td> 5</td>
      <td> 1</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# fill missing data
df4.fillna(value=5)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.000000</td>
      <td> 0.000000</td>
      <td> 0.610052</td>
      <td> 5</td>
      <td> 1</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-1.602831</td>
      <td> 5</td>
      <td> 1</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-1.462109</td>
      <td> 0.483201</td>
      <td>-1.044973</td>
      <td> 5</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.719197</td>
      <td>-0.499809</td>
      <td> 1.145788</td>
      <td> 5</td>
      <td> 5</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# boolean mask for nan values
pd.isnull(df4)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td>  True</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td> False</td>
      <td>  True</td>
    </tr>
  </tbody>
</table>
</div>



### Operations

**In:**


```python
df.mean()
```

**Out:**


    A   -0.180845
    B   -0.146705
    C   -0.247125
    D    5.000000
    dtype: float64



**In:**


```python
# pivot the mean calculation
df.mean(1)
```

**Out:**


    2013-01-01    1.402513
    2013-01-02    0.830223
    2013-01-03    0.744030
    2013-01-04    1.591294
    2013-01-05    0.774691
    2013-01-06    1.295239
    Freq: D, dtype: float64



**In:**


```python
# aligning objects with different dimensions
s = pd.Series([1,3,5,np.nan,6,8],index=dates).shift(2)
df.sub(s,axis='index')
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-2.462109</td>
      <td>-0.516799</td>
      <td>-2.044973</td>
      <td>  4</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td>-2.280803</td>
      <td>-3.499809</td>
      <td>-1.854212</td>
      <td>  2</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-6.161051</td>
      <td>-5.115774</td>
      <td>-5.624413</td>
      <td>  0</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>      NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# applying functions
df.apply(np.cumsum)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013-01-01</th>
      <td> 0.000000</td>
      <td> 0.000000</td>
      <td> 0.610052</td>
      <td>  5</td>
    </tr>
    <tr>
      <th>2013-01-02</th>
      <td> 0.818113</td>
      <td>-0.894390</td>
      <td>-0.992779</td>
      <td> 10</td>
    </tr>
    <tr>
      <th>2013-01-03</th>
      <td>-0.643997</td>
      <td>-0.411189</td>
      <td>-2.037752</td>
      <td> 15</td>
    </tr>
    <tr>
      <th>2013-01-04</th>
      <td> 0.075200</td>
      <td>-0.910998</td>
      <td>-0.891963</td>
      <td> 20</td>
    </tr>
    <tr>
      <th>2013-01-05</th>
      <td>-1.085851</td>
      <td>-1.026772</td>
      <td>-1.516376</td>
      <td> 25</td>
    </tr>
    <tr>
      <th>2013-01-06</th>
      <td>-1.085068</td>
      <td>-0.880228</td>
      <td>-1.482748</td>
      <td> 30</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df.apply(lambda x: x.max() - x.min())
```

**Out:**


    A    2.280222
    B    1.377591
    C    2.748619
    D    0.000000
    dtype: float64



**In:**


```python
# simple count aggregation
s = pd.Series(np.random.randint(0,7,size=10))
s.value_counts()
```

**Out:**


    4    3
    6    2
    1    2
    0    2
    5    1
    dtype: int64



### Merging / Grouping / Shaping

**In:**


```python
# concatenation
df = pd.DataFrame(np.random.randn(10, 4))
pieces = [df[:3], df[3:7], df[7:]]
pd.concat(pieces)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.006589</td>
      <td>-1.232048</td>
      <td>-0.147323</td>
      <td> 0.709050</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.201048</td>
      <td> 0.675688</td>
      <td> 1.110037</td>
      <td> 0.553489</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.159224</td>
      <td>-1.226735</td>
      <td>-0.141689</td>
      <td>-1.450920</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.049450</td>
      <td>-0.438565</td>
      <td> 0.670832</td>
      <td> 1.089032</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.105969</td>
      <td>-0.891644</td>
      <td> 0.626482</td>
      <td> 0.416679</td>
    </tr>
    <tr>
      <th>5</th>
      <td>-1.103222</td>
      <td>-1.983806</td>
      <td> 0.282366</td>
      <td> 0.031730</td>
    </tr>
    <tr>
      <th>6</th>
      <td> 0.380308</td>
      <td>-0.397791</td>
      <td>-0.322955</td>
      <td> 0.074480</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.623134</td>
      <td>-0.205967</td>
      <td>-0.367622</td>
      <td> 1.437279</td>
    </tr>
    <tr>
      <th>8</th>
      <td>-0.481202</td>
      <td> 1.242607</td>
      <td>-2.107715</td>
      <td> 1.020051</td>
    </tr>
    <tr>
      <th>9</th>
      <td>-0.345859</td>
      <td>-0.759047</td>
      <td>-0.927940</td>
      <td> 1.487916</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# SQL-style join
left = pd.DataFrame({'key': ['foo', 'foo'], 'lval': [1, 2]})
right = pd.DataFrame({'key': ['foo', 'foo'], 'rval': [4, 5]})
pd.merge(left, right, on='key')
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>lval</th>
      <th>rval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> foo</td>
      <td> 1</td>
      <td> 4</td>
    </tr>
    <tr>
      <th>1</th>
      <td> foo</td>
      <td> 1</td>
      <td> 5</td>
    </tr>
    <tr>
      <th>2</th>
      <td> foo</td>
      <td> 2</td>
      <td> 4</td>
    </tr>
    <tr>
      <th>3</th>
      <td> foo</td>
      <td> 2</td>
      <td> 5</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# append
df = pd.DataFrame(np.random.randn(8, 4), columns=['A', 'B', 'C', 'D'])
s = df.iloc[3]
df.append(s, ignore_index=True)
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.992219</td>
      <td> 1.298979</td>
      <td> 0.998799</td>
      <td>-0.164381</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0.902147</td>
      <td> 1.118289</td>
      <td>-0.169358</td>
      <td> 0.117833</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 1.201061</td>
      <td>-1.699020</td>
      <td>-2.112810</td>
      <td>-1.412482</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 1.084910</td>
      <td> 1.171135</td>
      <td> 0.384876</td>
      <td> 0.535239</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.922543</td>
      <td>-0.018670</td>
      <td>-1.506012</td>
      <td> 0.293739</td>
    </tr>
    <tr>
      <th>5</th>
      <td> 0.481017</td>
      <td> 0.639182</td>
      <td>-0.090676</td>
      <td> 0.951261</td>
    </tr>
    <tr>
      <th>6</th>
      <td> 1.201241</td>
      <td> 2.528836</td>
      <td>-0.530795</td>
      <td> 0.901950</td>
    </tr>
    <tr>
      <th>7</th>
      <td> 0.899290</td>
      <td> 0.562738</td>
      <td> 1.566468</td>
      <td>-0.846827</td>
    </tr>
    <tr>
      <th>8</th>
      <td> 1.084910</td>
      <td> 1.171135</td>
      <td> 0.384876</td>
      <td> 0.535239</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df = pd.DataFrame(
    { 'A' : ['foo', 'bar', 'foo', 'bar', 'foo', 'bar', 'foo', 'foo'],
      'B' : ['one', 'one', 'two', 'three', 'two', 'two', 'one', 'three'],
      'C' : np.random.randn(8),
      'D' : np.random.randn(8) })
df
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> foo</td>
      <td>   one</td>
      <td> 0.193948</td>
      <td>-1.385614</td>
    </tr>
    <tr>
      <th>1</th>
      <td> bar</td>
      <td>   one</td>
      <td>-0.257859</td>
      <td> 2.127808</td>
    </tr>
    <tr>
      <th>2</th>
      <td> foo</td>
      <td>   two</td>
      <td>-0.944848</td>
      <td>-0.760487</td>
    </tr>
    <tr>
      <th>3</th>
      <td> bar</td>
      <td> three</td>
      <td>-0.872161</td>
      <td>-1.707254</td>
    </tr>
    <tr>
      <th>4</th>
      <td> foo</td>
      <td>   two</td>
      <td>-0.658552</td>
      <td> 0.175699</td>
    </tr>
    <tr>
      <th>5</th>
      <td> bar</td>
      <td>   two</td>
      <td>-1.887614</td>
      <td> 0.627801</td>
    </tr>
    <tr>
      <th>6</th>
      <td> foo</td>
      <td>   one</td>
      <td> 0.439001</td>
      <td>-2.264125</td>
    </tr>
    <tr>
      <th>7</th>
      <td> foo</td>
      <td> three</td>
      <td>-0.829368</td>
      <td>-1.229315</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# group by
df.groupby('A').sum()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bar</th>
      <td>-3.017634</td>
      <td> 1.048355</td>
    </tr>
    <tr>
      <th>foo</th>
      <td>-1.799818</td>
      <td>-5.463842</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# group by multiple columns
df.groupby(['A','B']).sum()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">bar</th>
      <th>one</th>
      <td>-0.257859</td>
      <td> 2.127808</td>
    </tr>
    <tr>
      <th>three</th>
      <td>-0.872161</td>
      <td>-1.707254</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-1.887614</td>
      <td> 0.627801</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">foo</th>
      <th>one</th>
      <td> 0.632949</td>
      <td>-3.649739</td>
    </tr>
    <tr>
      <th>three</th>
      <td>-0.829368</td>
      <td>-1.229315</td>
    </tr>
    <tr>
      <th>two</th>
      <td>-1.603400</td>
      <td>-0.584788</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
df = pd.DataFrame(
    { 'A' : ['one', 'one', 'two', 'three'] * 3,
      'B' : ['A', 'B', 'C'] * 4,
      'C' : ['foo', 'foo', 'foo', 'bar', 'bar', 'bar'] * 2,
      'D' : np.random.randn(12),
      'E' : np.random.randn(12)} )
df
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td>   one</td>
      <td> A</td>
      <td> foo</td>
      <td>-0.853288</td>
      <td> 2.549878</td>
    </tr>
    <tr>
      <th>1 </th>
      <td>   one</td>
      <td> B</td>
      <td> foo</td>
      <td> 0.552557</td>
      <td> 0.865465</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>   two</td>
      <td> C</td>
      <td> foo</td>
      <td> 0.700943</td>
      <td> 0.800563</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> three</td>
      <td> A</td>
      <td> bar</td>
      <td>-0.466072</td>
      <td> 0.011508</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>   one</td>
      <td> B</td>
      <td> bar</td>
      <td> 0.465724</td>
      <td> 1.087874</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>   one</td>
      <td> C</td>
      <td> bar</td>
      <td> 1.105949</td>
      <td>-0.118134</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>   two</td>
      <td> A</td>
      <td> foo</td>
      <td>-0.666630</td>
      <td>-0.143474</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> three</td>
      <td> B</td>
      <td> foo</td>
      <td> 0.644902</td>
      <td> 1.731818</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>   one</td>
      <td> C</td>
      <td> foo</td>
      <td> 0.819170</td>
      <td>-1.153036</td>
    </tr>
    <tr>
      <th>9 </th>
      <td>   one</td>
      <td> A</td>
      <td> bar</td>
      <td>-1.849893</td>
      <td> 0.733137</td>
    </tr>
    <tr>
      <th>10</th>
      <td>   two</td>
      <td> B</td>
      <td> bar</td>
      <td> 0.684170</td>
      <td>-0.276237</td>
    </tr>
    <tr>
      <th>11</th>
      <td> three</td>
      <td> C</td>
      <td> bar</td>
      <td> 0.592939</td>
      <td>-0.830433</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# pivot table
pd.pivot_table(df, values='D', rows=['A', 'B'], columns=['C'])
```

**Out:**

<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>bar</th>
      <th>foo</th>
    </tr>
    <tr>
      <th>A</th>
      <th>B</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">one</th>
      <th>A</th>
      <td>-1.849893</td>
      <td>-0.853288</td>
    </tr>
    <tr>
      <th>B</th>
      <td> 0.465724</td>
      <td> 0.552557</td>
    </tr>
    <tr>
      <th>C</th>
      <td> 1.105949</td>
      <td> 0.819170</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">three</th>
      <th>A</th>
      <td>-0.466072</td>
      <td>      NaN</td>
    </tr>
    <tr>
      <th>B</th>
      <td>      NaN</td>
      <td> 0.644902</td>
    </tr>
    <tr>
      <th>C</th>
      <td> 0.592939</td>
      <td>      NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">two</th>
      <th>A</th>
      <td>      NaN</td>
      <td>-0.666630</td>
    </tr>
    <tr>
      <th>B</th>
      <td> 0.684170</td>
      <td>      NaN</td>
    </tr>
    <tr>
      <th>C</th>
      <td>      NaN</td>
      <td> 0.700943</td>
    </tr>
  </tbody>
</table>
</div>



### Time Series

**In:**


```python
# time period resampling
rng = pd.date_range('1/1/2012', periods=100, freq='S')
ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng)
ts.resample('5Min', how='sum')
```

**Out:**


    2012-01-01    24406
    Freq: 5T, dtype: int32



**In:**


```python
rng = pd.date_range('1/1/2012', periods=5, freq='M')
ts = pd.Series(np.random.randn(len(rng)), index=rng)
ts
```

**Out:**


    2012-01-31   -0.624893
    2012-02-29   -0.176292
    2012-03-31    1.673556
    2012-04-30    0.707903
    2012-05-31    0.533647
    Freq: M, dtype: float64



**In:**


```python
ps = ts.to_period()
ps.to_timestamp()
```

**Out:**


    2012-01-01   -0.624893
    2012-02-01   -0.176292
    2012-03-01    1.673556
    2012-04-01    0.707903
    2012-05-01    0.533647
    Freq: MS, dtype: float64



### Plotting

**In:**


```python
# time series plot
ts = pd.Series(np.random.randn(1000), index=pd.date_range('1/1/2000', periods=1000))
ts = ts.cumsum()
ts.plot()
```

**Out:**


    <matplotlib.axes._subplots.AxesSubplot at 0xd180438>


<p style="text-align:center"><img src="/assets/img/post/pandas/output_56_1.png"></p>



**In:**

```python
# plot with a data frame
df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index, columns=['A', 'B', 'C', 'D'])
df = df.cumsum()
plt.figure(); df.plot(); plt.legend(loc='best')
```

**Out:**


```python
<matplotlib.legend.Legend at 0xd541fd0>
```
```python
<matplotlib.figure.Figure at 0xd554550>
```


<p style="text-align:center"><img src="/assets/img/post/pandas/output_57_2.png"></p>



### Input / Output

**In:**


```python
# write to a csv file
df.to_csv('foo.csv', index=False)

# read file back in
path = r'C:\Users\John\Documents\IPython Notebooks\foo.csv'
newDf = pd.read_csv(path)
newDf.head()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.914956</td>
      <td> 0.294759</td>
      <td> 0.143332</td>
      <td> 0.174706</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.297442</td>
      <td> 1.640208</td>
      <td> 0.425301</td>
      <td>-0.075666</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.762292</td>
      <td> 0.741179</td>
      <td> 0.505002</td>
      <td>-0.128560</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.577471</td>
      <td>-0.495294</td>
      <td> 1.803332</td>
      <td> 0.188178</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.137486</td>
      <td>-0.676985</td>
      <td> 1.435308</td>
      <td> 0.181047</td>
    </tr>
  </tbody>
</table>
</div>



**In:**


```python
# remove the file
import os
os.remove(path)

# can also do Excel
df.to_excel('foo.xlsx', sheet_name='Sheet1')

newDf2 = pd.read_excel('foo.xlsx', 'Sheet1', index_col=None, na_values=['NA'])
newDf2.head()
```

**Out:**


<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>-0.914956</td>
      <td> 0.294759</td>
      <td> 0.143332</td>
      <td> 0.174706</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>-0.297442</td>
      <td> 1.640208</td>
      <td> 0.425301</td>
      <td>-0.075666</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>-0.762292</td>
      <td> 0.741179</td>
      <td> 0.505002</td>
      <td>-0.128560</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>-1.577471</td>
      <td>-0.495294</td>
      <td> 1.803332</td>
      <td> 0.188178</td>
    </tr>
    <tr>
      <th>2000-01-05</th>
      <td>-0.137486</td>
      <td>-0.676985</td>
      <td> 1.435308</td>
      <td> 0.181047</td>
    </tr>
  </tbody>
</table>
</div>
